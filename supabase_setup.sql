-- Create Menu Items Table
CREATE TABLE IF NOT EXISTS menu_items (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    label TEXT NOT NULL,
    action_id TEXT NOT NULL,
    order_index INTEGER DEFAULT 0,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc'::text, now()) NOT NULL
);

ALTER TABLE menu_items ENABLE ROW LEVEL SECURITY;
DROP POLICY IF EXISTS "Enable read access for all users" ON menu_items;
CREATE POLICY "Enable read access for all users" ON menu_items FOR SELECT USING (true);
DROP POLICY IF EXISTS "Enable all access for all users" ON menu_items;
CREATE POLICY "Enable all access for all users" ON menu_items FOR ALL USING (true);

-- Create Site Assets Table
CREATE TABLE IF NOT EXISTS site_assets (
    key TEXT PRIMARY KEY,
    value TEXT NOT NULL,
    description TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc'::text, now()) NOT NULL
);

ALTER TABLE site_assets ENABLE ROW LEVEL SECURITY;
DROP POLICY IF EXISTS "Enable read access for all users" ON site_assets;
CREATE POLICY "Enable read access for all users" ON site_assets FOR SELECT USING (true);
DROP POLICY IF EXISTS "Enable all access for all users" ON site_assets;
CREATE POLICY "Enable all access for all users" ON site_assets FOR ALL USING (true);

-- Storage Bucket Setup (Reminder: Check Dashboard)

-- Insert Default Data
INSERT INTO menu_items (label, action_id, order_index) VALUES
('ğŸƒ ê³¨ëª©ê¸¸ (ë†€ì´)', 'playground', 1),
('ğŸ« êµì‹¤ í’ê²½', 'school', 2),
('ğŸ­ í•™êµ ì• ë¬¸ë°©êµ¬', 'store', 3),
('ğŸ“° ê·¸ ì‹œì ˆ ë‰´ìŠ¤', 'timeline', 4),
('ğŸ–¼ï¸ AI ì¶”ì–µ ë³µì›', 'prompts', 5)
ON CONFLICT DO NOTHING;

-- Insert Image Assets (Mapping existing local paths)
INSERT INTO site_assets (key, value, description) VALUES
('main_title', 'ì‘ë‹µí•˜ë¼ 1980', 'The main H1 title'),
('main_subtitle', 'êµ­ë¯¼í•™êµì™€ ì¤‘í•™êµ ì‹œì ˆì˜ ë”°ëœ»í•œ ì¶”ì–µ ê¸°ë¡ì¥', 'The subtitle'),
('img_marbles_main', 'images/retro_alley_marbles.png', 'êµ¬ìŠ¬ì¹˜ê¸° ëŒ€ë°±ê³¼ ë©”ì¸ ì´ë¯¸ì§€'),
('img_ddakkji', 'images/retro_ddakkji_game.png', 'ë”±ì§€ì¹˜ê¸° ì´ë¯¸ì§€'),
('img_rubber_band', 'images/retro_rubber_band_game.png', 'ê³ ë¬´ì¤„ ë†€ì´ ì´ë¯¸ì§€'),
('img_hopscotch', 'images/retro_hopscotch.png', 'ì‚¬ë°©ì¹˜ê¸° ì´ë¯¸ì§€'),
('img_lunchbox', 'images/retro_school_lunchbox.png', 'ì–‘ì²  ë„ì‹œë½ ì´ë¯¸ì§€'),
('img_nametag', 'images/retro_nametag_handkerchief.png', 'ëª…ì°°ê³¼ ì†ìˆ˜ê±´ ì´ë¯¸ì§€'),
('img_stool', 'images/retro_stool_envelope.png', 'ì±„ë³€ ë´‰íˆ¬ ì´ë¯¸ì§€'),
('img_chalkboard', 'images/retro_chalkboard_names.png', 'ë– ë“  ì‚¬ëŒ ëª…ë‹¨ ì´ë¯¸ì§€'),
('img_uniform', 'images/retro_school_uniform_reveal.png', 'êµë ¨ë³µ ê³µê°œ ì´ë¯¸ì§€'),
('img_snacks_main', 'images/retro_stationery_store_snacks.png', 'ë¬¸ë°©êµ¬ ë©”ì¸ ì´ë¯¸ì§€'),
('img_baseball', 'images/retro_baseball_1982.png', 'í”„ë¡œì•¼êµ¬ ì´ë¯¸ì§€'),
('img_gallery_winter', 'images/retro_classroom_winter.png', 'ê°¤ëŸ¬ë¦¬: ê²¨ìš¸ êµì‹¤'),
('img_gallery_store', 'images/stationery_store.png', 'ê°¤ëŸ¬ë¦¬: ë¬¸ë°©êµ¬'),
('img_gallery_olympic', 'images/olympic_88.png', 'ê°¤ëŸ¬ë¦¬: ì˜¬ë¦¼í”½'),
('img_90s_arcade', 'https://images.unsplash.com/photo-1511512578047-dfb367046420?auto=format&fit=crop&q=80&w=600', '90s ì˜¤ë½ì‹¤ ì´ë¯¸ì§€'),
('img_90s_fashion', 'images/90s_fashion.png', '90s íŒ¨ì…˜ ì´ë¯¸ì§€')
ON CONFLICT DO NOTHING;
